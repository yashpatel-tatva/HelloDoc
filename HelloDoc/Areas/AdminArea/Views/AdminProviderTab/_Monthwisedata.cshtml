@{
    Layout = "_SchedulerLayout";
}

@using DataModels.AdminSideViewModels
@model SchedulingDataViewModel
<style>
    table {
        border-collapse: collapse;
        width: 100%;
    }

    th, td {
        border: 1px solid #dee2e6;
        padding: 8px;
        text-align: left;
    }

    .events {
        padding: 6px;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        font-size: small;
        margin: 1px
    }
</style>
<div class="table-responsive bg-light shadow" id="content">
    <table class="w-100 border-1">
        <thead style="background: rgb(145 145 145) ; color : white !important ; text-align : center">
            <tr>
                <th style="width : 14.28%; text-align : center">SUN</th>
                <th style="width : 14.28%; text-align : center">MON</th>
                <th style="width : 14.28%; text-align : center">TUE</th>
                <th style="width : 14.28%; text-align : center">WED</th>
                <th style="width : 14.28%; text-align : center">THU</th>
                <th style="width : 14.28%; text-align : center">FRI</th>
                <th style="width : 14.28%; text-align : center">SAT</th>
            </tr>
        </thead>
        <tbody>
            @{
                var firstdate = Model.firstMonthdate;
                var daysleft = (int)firstdate.DayOfWeek;
                int daysInMonth = DateTime.DaysInMonth(firstdate.Year, firstdate.Month);
                int day = 1;
                int flag = 1;
                int tempt = day;
            }
            @while (day <= daysInMonth - 7)
            {
                @if (flag == 1)
                {
                    <tr>
                        @if (daysleft != 0)
                        {
                            <td colspan="@daysleft"></td>
                        }
                        @for (int curr = 1; curr <= 7 - daysleft; curr++)
                        {
                            <td style=" background : #efabd2;text-align : center ; color:white">@day</td>
                            day++;
                        }
                    </tr>
                    tempt = 1;
                    <tr>
                        @if (daysleft != 0)
                        {
                            <td colspan="@daysleft"></td>
                        }
                        @for (int curr = 1; curr <= 7 - daysleft; curr++)
                        {
                            <td id="1_@tempt"><div style="min-height:5px"></div></td>
                            tempt++;
                        }
                    </tr>
                    tempt = 1;
                    <tr>
                        @if (daysleft != 0)
                        {
                            <td colspan="@daysleft"></td>
                        }
                        @for (int curr = 1; curr <= 7 - daysleft; curr++)
                        {
                            <td id="2_@tempt"></td>
                            tempt++;
                        }
                    </tr>
                    tempt = 1;
                    <tr>
                        @if (daysleft != 0)
                        {
                            <td colspan="@daysleft"></td>
                        }
                        @for (int curr = 1; curr <= 7 - daysleft; curr++)
                        {
                            <td id="3_@tempt"><div style="min-height:25px" class="LoadMore" id="next_@tempt"></div></td>
                            tempt++;
                        }
                    </tr>

                    flag = 2;
                }
                else
                {
                    tempt = day;
                    var tempt2 = tempt;
                    <tr>
                        @for (int curr = 1; curr <= 7; curr++)
                        {
                            <td style=" background : #efabd2;text-align : center ; color:white">@day</td>
                            day++;
                        }
                    </tr>
                    <tr>
                        @for (int curr = 1; curr <= 7; curr++)
                        {
                            <td id="1_@tempt"><div style="min-height:5px"></div></td>
                            tempt++;
                        }
                    </tr>
                    tempt = tempt2;
                    <tr>
                        @for (int curr = 1; curr <= 7; curr++)
                        {
                            <td id="2_@tempt"></td>
                            tempt++;
                        }
                    </tr>
                    tempt = tempt2;
                    <tr>
                        @for (int curr = 1; curr <= 7; curr++)
                        {
                            <td id="3_@tempt"><div style="min-height:25px" class="LoadMore" id="next_@tempt"></div></td>
                            tempt++;
                        }
                    </tr>
                }
            }
            @{
                tempt = day;
            }
            <tr>
                @while (day <= daysInMonth)
                {
                    <td style=" background : #efabd2;text-align : center ; color:white">@day</td>
                    day++;
                }
            </tr>
            @{
                var tempt1 = tempt;
            }
            <tr>
                @while (tempt1 <= daysInMonth)
                {
                    <td id="1_@tempt1"><div style="min-height:5px"></div></td>
                    tempt1++;
                }
            </tr>
            @{
                tempt1 = tempt;
            }
            <tr>
                @while (tempt1 <= daysInMonth)
                {
                    <td id="2_@tempt1"></td>
                    tempt1++;
                }
            </tr>
            @{
                tempt1 = tempt;
            }
            <tr>
                @while (tempt1 <= daysInMonth)
                {
                    <td id="3_@tempt1"><div style="min-height:25px" class="LoadMore" id="next_@tempt"></div></td>
                    tempt1++;
                }
            </tr>
        </tbody>
    </table>
</div>
@foreach (var shift in Model.Shifts)
{
    <script>
        var shiftdate = @shift.StartTime.ToString("dd");
        var timeslot = "2_" + shiftdate;
        var color = "";
        if (@shift.Status == 1) {
            color = "#ffd4ed";
        }
        if (@shift.Status == 2) {
            color = "#cee9cd";
        }
        $('#' + timeslot).css("padding", "0px")
        $('#' + timeslot).append('<div class="events  text-dark" id="event_@shift.ShiftId" data-id="@shift.ShiftId" data-url="MonthWiseData"> @Model.physicianDatas.FirstOrDefault(x=>x.Physicianid==shift.Physicianid).Physicianname <br> @shift.StartTime.ToString("hh:mm tt") - @shift.EndTime.ToString("hh:mm tt")</div>');
        $('#event_@shift.ShiftId').css("background-color", color);
    </script>
}
@*
<script>
    var next = 1;
    var dateObj = new Date("@firstdate.Year", "@firstdate.Month", 1);
    var region = $('.drawbyregiondropdown').val();
    var status = $('input[name="shiftstatus"]:checked').val();
    $('.LoadMore').on('click', function () {
        var str = $(this).attr('id');
        var parse = str.split('_');
        var date = parse[1];
        var year = "@firstdate.Year";
        var month = "@firstdate.Month";
        dateObj = new Date(year, month - 1, date);
        console.log(dateObj);
        loadshiftdata(dateObj, next);
    });


    loadshiftdata(dateObj, 0);

    function loadshiftdata(date, next) {
        console.log(next)
        console.log(dateObj)
        console.log(region)
        console.log(status)
        //$.ajax({
        //    url: '/AdminArea/AdminProviderTab/GetNextShiftsOfDate',
        //    date: { date: date, next: next },
        //    type: 'POST',
        //    success: function (data) {
        //        $.each(data, function (index, shift) {

        //        });
        //    },
        //});
    }
</script>*@
<script src="~/js/Events.js" asp-append-version="true"></script>
