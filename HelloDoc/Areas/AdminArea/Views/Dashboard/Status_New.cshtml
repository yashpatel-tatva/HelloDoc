@{
    Layout = null;
}
@using DataModels.AdminSideViewModels;
@model List<AllRequestDataViewModel>


<table class="table" id="newtable">
    <thead style="--bs-table-bg: rgb(235, 235, 235)">
        <tr>
            <th class="d-none"></th>
            <th style="width : 17%">Name</th>
            <th style="width : 8%">Date of Birth</th>
            <th style="width : 9%">Requestor</th>
            <th style="width : 9%">Date of Service</th>
            <th style="width : 11%">Phone</th>
            <th style="width : 14%">Address</th>
            <th style="width : 17%">Notes</th>
            <th style="width : 9%">Chat With</th>
            <th style="width : 6%">Action</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            var color = "";
            @switch (item.RequestType)
            {
                case 1:
                    color = "#66bb63";
                    break;
                case 2:
                    color = "#e59132";
                    break;
                case 3:
                    color = "#d8697b";
                    break;
                case 4:
                    color = "#077aba";
                    break;
                default:
                    color = "#9042af";
                    break;

            }
            <tr style="--bs-table-bg : @color ; --bs-table-color-state : 'white'" class="text-white align-middle">
                <td class="d-none">@item.RequestType</td>
                <td>@item.PatientName</td>
                <td>@item.PatientDOB</td>
                <td>@item.RequestorName</td>
                <td>@item.RequestedDate</td>
                @if (item.RequestType == 1)
                {
                    @if (@item.PatientPhone != null)
                    {
                        <td>
                            <div class="">
                                <div class="border border-1 border-white rounded w-100 d-flex justify-content-around"><i class="bi bi-telephone"></i>  @item.PatientPhone</div>
                                <div>(Patient)</div>
                            </div>
                        </td>
                    }
                    else
                    {
                        <td></td>
                    }
                }
                else
                {
                    <td>
                        @if (@item.PatientPhone != null)
                        {
                            <div>
                                <div class="border border-1 border-white rounded w-100 d-flex justify-content-around"><i class="bi bi-telephone"></i>@item.PatientPhone</div>
                                <div>(Patient)</div>
                            </div>
                        }

                        @if (@item.RequestorPhone != null)
                        {
                            <div>
                                <div class="border border-1 border-white rounded w-100 d-flex justify-content-around"><i class="bi bi-telephone"></i> @item.RequestorPhone </div>
                                <div>(@item.RequestTypeName(item.RequestType))</div>
                            </div>
                        }
                        
                    </td>
                }
                <td>@item.Address</td>
                <td>@item.Notes</td>
                <td>@item.ProviderEmail
                    <div class="border border-1 border-white rounded d-flex justify-content-around align-items-center" style="width : 90%">
                        <i class="fa-solid fa-user-doctor"></i>
                        Provider
                    </div>
                </td>
                <td>
                    <div class="dropdown">
                        <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Action
                        </button>
                        <ul class="dropdown-menu">
                            <li>1</li>
                            <li>2</li>
                            <li>3</li>
                            <li>4</li>
                            <li>5</li>
                        </ul>
                    </div>
                </td>
            </tr>
        }

    </tbody>
</table>


<script>
    $(document).ready(function () {
        var table = $('#newtable').DataTable({ dom: 'lrtip' }); // Initialize your DataTable
        $('input[type="search"]').on('keyup', function () {
            table.search(this.value).draw();
        });
        $('input[name="requestby"]').on('change', function () {
            var value = $(this).attr('id');
            console.log(value);
            if (value == 'requestbyAll') {
                table.columns(0).search('').draw();
            }
            else {
                table.columns(0).search(value).draw(); // Replace 0 with the index of the column you want to filter
            }
        });
    });
    
</script>



